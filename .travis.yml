language: cpp

cache: # see https://docs.travis-ci.com/user/caching/
  - directories:
      - $HOME/.cache

matrix:
  include:
  - os: linux
    dist: bionic
    compiler: g++
    sudo: false
    addons:
      apt:
        packages:
        - cmake
        - cmake-data
        - libhdf5-dev
        - libtiff5
        - lcov
        - libgtest-dev
        - libblosc-dev
  - os: osx
    osx_image: xcode11.4
  - os: windows
    language: cpp


install:
- mkdir -p $HOME/.cache
- touch $HOME/.cache/mydependency.so
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install c-blosc; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then echo "UPDATESTARTUPTTY" | gpg-connect-agent > /dev/null 2>&1; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install cmake || brew upgrade cmake ; fi
- if [[ "$TRAVIS_OS_NAME" == "windows" ]]; then travis_wait 10 choco install visualstudio2019buildtools --params "--add Microsoft.Component.MSBuild --add Microsoft.VisualStudio.Component.VC.Llvm.Clang --add Microsoft.VisualStudio.Component.VC.Llvm.ClangToolset --add Microsoft.VisualStudio.ComponentGroup.NativeDesktop.Llvm.Clang --add Microsoft.VisualStudio.Component.Windows10SDK.19041	--add Microsoft.VisualStudio.Component.VC.Tools.x86.x64 --add Microsoft.VisualStudio.ComponentGroup.UWP.VC.BuildTools"; fi
- git submodule init
- git submodule update

script:
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sh ./cmake-build-linux.sh; fi
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then sh ./cmake-build-osx.sh; fi
- if [[ "$TRAVIS_OS_NAME" == "windows" ]]; then travis_wait 40 sh ./cmake-build-windows.sh; fi

